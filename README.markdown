# Генератор Презентаций

Веб-приложение на FastAPI для автоматической генерации презентаций PowerPoint (`.pptx`) на заданную тему с использованием языковой модели (LLM) и API генерации изображений. Поддерживает два режима: обычная генерация и генерация по шаблону.

## Особенности
- **Обычная генерация**:
  - Создаёт презентацию с титульным слайдом (тема презентации) и контентными слайдами.
  - Каждый контентный слайд содержит заголовок, описание (200–230 слов) и изображение, сгенерированные с помощью LLM и API изображений.
- **Генерация по шаблону**:
  - Использует файл `templates/template.pptx` с тремя слайдами:
    - **Титульный слайд**: Заменяется только текст темы, стили сохраняются.
    - **Основной слайд**: Дублируется для каждого контентного слайда с заменой заголовка, описания и изображения.
    - **Последний слайд**: Копируется без изменений, если присутствует.
  - Минимальное количество слайдов: 3, максимальное: 20.
- **Веб-интерфейс**: Простая форма с выбором режима, темы, количества слайдов и имени файла, стилизованная с Tailwind CSS.
- **Интеграция**:
  - LLM (по умолчанию Llama3) для генерации текста слайдов в формате JSON.
  - API изображений для генерации изображений размером 768x768 пикселей.
- **Очистка**: Временные файлы (изображения и выходные `.pptx`) удаляются при завершении работы сервера, шаблон сохраняется.
- **Логирование**: Используется `loguru` для диагностики ошибок и отладки.

## Требования
- Python 3.13
- Poetry для управления зависимостями
- Microsoft PowerPoint (для создания `template.pptx`, опционально)
- Доступ к серверу LLM (по умолчанию `http://192.168.0.59:8087`)
- Доступ к API изображений (по умолчанию `http://192.168.0.67:8009`)

## Установка
1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/nightboyfriend/generate-presentation
   cd generate-presentation
   ```

2. **Установите зависимости**:
   ```bash
   poetry install
   ```

3. **Настройте переменные окружения**:
     ```env
     MODEL=Llama3
     LLM_HOST=http://192.168.0.59
     LLM_PORT=8087
     IMAGE_API_HOST=http://192.168.0.67
     IMAGE_API_PORT=8009
     ```
   - Убедитесь, что указанные адреса LLM и API изображений доступны.

4. **Проверка шаблона**:
     ```bash
     poetry run python check_template.py
     ```
   Ожидаемый вывод:
   ```
   Шаблон загружен: templates/template.pptx
   Количество слайдов: 3
   Титульный слайд: Найден плейсхолдер заголовка
   Основной слайд:
     Плейсхолдер заголовка: найден
     Плейсхолдер текста: найден
     Плейсхолдер изображения: найден
   Последний слайд: Найден
   ```

## Использование
1. **Запустите сервер**:
   ```bash
   poetry run uvicorn generate_presentation.main:app --host 127.0.0.1 --port 8000 --reload
   ```

2. **Откройте веб-интерфейс**:
   - Перейдите по адресу `http://127.0.0.1:8000/static/index.html`.
   - Выберите режим.
   - Укажите тему, количество слайдов (1–20 для обычного, 3–20 для шаблонного) и имя файла.
   - Нажмите "Сгенерировать презентацию" для загрузки файла.

3. **Пример API-запроса**:
   ```bash
   curl -X POST "http://127.0.0.1:8000/generate-from-topic/" \
        -F "request={\"topic\": \"Космос\", \"slide_count\": 4, \"output_path\": \"my_presentation.pptx\", \"template_mode\": true}"
   ```

## Зависимости
`pyproject.toml`:
- `fastapi==0.115.0`
- `uvicorn==0.30.1`
- `python-pptx==1.0.2`
- `python-multipart==0.0.9`
- `python-dotenv==1.0.1`
- `openai==1.35.0`
- `loguru==0.7.2`
- `aiohttp==3.9.5`
- `pytest==8.3.5`
- `httpx==0.27.0`